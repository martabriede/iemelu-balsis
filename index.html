<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ZiemeÄ¼u Balsis â€” Latvian Mixed Choir in Estonia</title>
  <meta name="description" content="Latvian mixed choir in Estonia. Rehearsals in Tartu and Tallinn. Conductors MatÄ«ss Briedis and Rihards ZariÅ†Å¡." />
  <link rel="icon" href="images/logo.png">

  <style>
  /* ===============================
     THEME â€” Latvian red + white
     =============================== */
  :root{
    --bg:#ffffff; --text:#0f172a; --muted:#475569;
    --brand:#9E1B34;          /* Latvian carmine red */
    --brand-accent:#9E1B34;   /* same for buttons/links */
    --brand-dark:#7F152A;
    --card:#ffffff;
    --border:#E9D3D8;         /* subtle red-tinted border */
    --ring:rgba(158,27,52,.35);
    --sidebar:#9E1B34;        /* red sidebar */
    --tint:#FFF6F8;           /* very light red tint */
    --shadow:0 10px 20px rgba(158,27,52,.06), 0 2px 6px rgba(0,0,0,.05);
    --radius:18px;
    --radius-small:12px;
    --maxw:1100px;            /* nicer readable width */
  }

  *{box-sizing:border-box}
  html,body{
    margin:0;padding:0;background:var(--bg);color:var(--text);
    font:16px/1.7 system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
  }

  .layout{display:flex;min-height:100dvh}
  main{flex:1;min-width:0}
  .content{max-width:var(--maxw);margin:0 auto}

  /* ===== Sidebar (Latvian red with subtle LielvÄrde-like pattern) ===== */
  aside{
    width:280px;flex:0 0 280px;background:var(--sidebar);color:#fff;
    border-right:1px solid #7F152A;position:sticky;top:0;height:100dvh;
    padding:1rem;display:flex;flex-direction:column;gap:1rem;
    /* ornament: tiny white geometric tile, very subtle */
    background-image:
      radial-gradient(rgba(255,255,255,.06) 1px, transparent 1px),
      url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'><g fill='none' stroke='white' stroke-opacity='.18' stroke-width='1'><path d='M8 0L0 8M16 0L0 16M24 0L0 24M32 0L0 32'/><path d='M32 8L8 32M32 16L16 32M32 24L24 32'/></g></svg>");
    background-size:16px 16px, 32px 32px;
    background-blend-mode:overlay;
  }
  .brand{display:flex;align-items:center;gap:.75rem;font-weight:800}
  .brand img{width:44px;height:44px;border-radius:10px;background:#fff;padding:3px}
  nav ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:.45rem}
  nav a{
    display:block;padding:.55rem .7rem;border-radius:12px;
    color:#fff;text-decoration:none;border:1px solid transparent;
    transition:.2s ease;
  }
  nav a:hover{background:rgba(255,255,255,.12);border-color:rgba(255,255,255,.25)}
  nav a.btn{
    background:#fff;color:var(--brand);border-color:#fff;text-align:center;margin-top:.4rem;font-weight:700;
    box-shadow: var(--shadow);
  }
  nav a.btn:hover{filter:brightness(.96)}
/* === Active sidebar link â€” logo only, no frame === */
aside nav a.active{
  position: relative;
  font-weight: 700;
  padding-left: 2.2rem;   /* room for the logo */
  background: transparent;
  border-color: transparent;
  box-shadow: none;
}

aside nav a.active::before{
  content:"";
  position:absolute;
  left:.6rem; top:50%;
  transform:translateY(-50%);
  width:16px; height:16px;
  background:url("images/logo.png") no-repeat center/contain;
  opacity:.95;
}
  .social{display:flex;gap:.8rem;flex-wrap:wrap;align-items:center}
  .social a{display:inline-flex;gap:.4rem;align-items:center;color:#fff;text-decoration:none}

  /* ===== Sections, typography, accents ===== */
  section{padding:2rem 1.25rem;border-bottom:1px solid var(--border)}
  .content section{padding:2rem 0}
  section h1,section h2{margin:.2rem 0 .8rem;letter-spacing:.2px}
  section h1, section h2{position:relative}
  section h1::after, section h2::after{
    content:"";display:block;width:64px;height:4px;margin-top:.45rem;border-radius:999px;background:var(--brand);
  }

  .grid{display:grid;gap:1.25rem}
  .grid.two{grid-template-columns:1fr}
  @media(min-width:900px){.grid.two{grid-template-columns:1fr 1fr}}

  .card{
    background:var(--card);border:1px solid var(--border);border-radius:var(--radius);
    padding:1rem;box-shadow:var(--shadow)
  }
  .btn{
    display:inline-block;padding:.8rem 1.1rem;border-radius:12px;
    border:1px solid var(--brand-accent);background:var(--brand-accent);color:#fff;
    box-shadow:var(--shadow);transition:.15s ease;
  }
  .btn:hover{transform:translateY(-1px);filter:brightness(.97)}

  a{ color: var(--brand); }
  a:hover{ text-decoration: underline; }

  /* Link badge (maps) */
  .link-badge{
    display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .75rem;border:1px solid var(--border);
    border-radius:999px;font-size:.95rem;text-decoration:none;background:#fff;box-shadow:var(--shadow)
  }
  .link-badge:hover{background:var(--tint)}

  /* Media compact (you already have it, refined colours) */
  #news .news-grid{display:grid;gap:.9rem;grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
  #news .news-card{border:1px solid var(--border);border-radius:14px;background:#fff;padding:.85rem .9rem;box-shadow:var(--shadow)}
  #news .news-card h3{font-size:1rem;line-height:1.35;margin:0 0 .45rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
  #news .meta-row{display:flex;align-items:center;gap:.45rem;color:#64748b;font-size:.9rem;margin-bottom:.45rem}
  #news .meta-row img{width:16px;height:16px;border-radius:4px;flex:0 0 16px}
  #news .actions{margin-top:.25rem}
  #news .read-link{font-size:.92rem;text-decoration:none;display:inline-flex;align-items:center;gap:.35rem;padding:.35rem .55rem;border:1px solid var(--border);border-radius:999px;color:var(--brand);background:#fff}
  #news .read-link:hover{background:var(--tint)}
  #news .toggle-wrap{text-align:center;margin-top:.8rem}
  #news .toggle-btn{background:var(--brand);color:#fff;border:1px solid var(--brand);padding:.5rem .9rem;border-radius:999px;cursor:pointer;font-size:.95rem;box-shadow:var(--shadow)}

  /* Media & images */
  .media{width:100%;border-radius:16px;border:1px solid var(--border);object-fit:cover}
  .about-hero img{aspect-ratio:16/9;max-height:300px}
  .about-text p{margin:.5rem 0}
  
  .about-grid{display:grid;gap:1.25rem}
  @media(min-width:900px){.about-grid{grid-template-columns:1fr 1fr}}
  .portrait-card{background:#fff;border:1px solid var(--border);border-radius:14px;padding:.75rem;box-shadow:var(--shadow)}
  .portrait-img{display:block;width:100%;max-width:260px;margin:0 auto;aspect-ratio:3/4;object-fit:cover;border-radius:12px;border:1px solid var(--border)}
  .portrait-caption{text-align:center;color:var(--muted);font-size:.9rem;margin-top:.4rem}
  .video-wrap{margin-top:1rem;border:1px solid var(--border);border-radius:var(--radius);background:#fff;padding:.5rem;box-shadow:var(--shadow)}

  /* Gallery */
  .gallery{display:grid;gap:1rem}
  @media(min-width:700px){.gallery{grid-template-columns:repeat(3,1fr)}}
  .gallery img{width:100%;border-radius:16px;border:1px solid var(--border);aspect-ratio:4/3;object-fit:cover;cursor:pointer;transition:.15s ease}
  .gallery img:hover{transform:scale(1.01)}

  /* Lightbox (for richer feel) */
  .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.75);display:none;align-items:center;justify-content:center;z-index:50}
  .lightbox.open{display:flex}
  .lightbox img{max-width:92vw;max-height:92vh;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.35)}
  .lightbox:focus{outline:none}

  footer{padding:2rem;color:#475569}

  /* Mobile tweaks */
  @media(max-width:900px){
    aside{position:relative;height:auto;width:100%;border-right:0;border-bottom:1px solid var(--border)}
    .layout{flex-direction:column}
    nav ul{flex-direction:row;flex-wrap:wrap}
    nav a{padding:.5rem .6rem}
  }
</style>
</head>

<body>
  <div class="layout">
    <aside>
      <div class="brand">
        <img src="images/logo.png" alt="ZiemeÄ¼u Balsis logo">
        <div>ZiemeÄ¼u Balsis</div>
      </div>
      <nav>
        <ul>
          <li><a href="#about" class="active">About us</a></li>
          <li><a href="#rehearsals">Rehearsals</a></li>
          <li><a href="#news">Media</a></li>
          <li><a href="#gallery">Gallery</a></li>
          <li><a href="#contact">Contacts</a></li>
        </ul>
        <a class="btn" href="https://forms.gle/sJ83ptDXcackn1jQA" target="_blank" rel="noopener">Register here</a>
      </nav>
    </aside>

    <main>
  <div class="content">
      <!-- ABOUT US -->
      <section id="about">
        <h1>About us</h1>
        <div class="about-hero">
          <img class="media" src="images/hero.jpg" alt="ZiemeÄ¼u Balsis group photo">
        </div>
        <div class="about-text">
          <p>The Latvian choir in Estonia "ZiemeÄ¼u Balsis" was founded in 2012. Today, the choir unites singers from ten different countries. ZiemeÄ¼u Balsis is special not only for its international membership but also for its ability to bring together people from two Estonian cities â€” Tartu and Tallinn. Thanks to regular joint rehearsals, the choir has grown into a truly harmonious and united collective.</p>
          <p>We are proud to be the first choir to take part in all three Baltic Song Festivals: the Latvian Song Festival (2013, 2018, 2023), the Lithuanian Song Festival (2024), and the Estonian Song Festival (2025). This achievement reflects our dedication to carrying Baltic choral traditions across borders.</p>
          <p>Our musical direction is led by two inspiring conductors â€” MatÄ«ss Briedis and Rihards ZariÅ†Å¡.</p>
          <p>MatÄ«ss Briedis studied at the Heino Eller Music School, graduating in 2017, and at the Estonian Academy of Music and Theatre, where he is now pursuing his Masterâ€™s degree in conducting. A member of ZiemeÄ¼u Balsis since 2013, MatÄ«ss became one of the choirâ€™s conductors in 2017. He has guided several choirs in Tartu and Tallinn to national song festivals across the Baltics.</p>
          <p>Rihards ZariÅ†Å¡ began his musical journey in 1998 at the Riga Cathedral Choir School and continued at the JÄzeps VÄ«tols Academy of Music in Latvia. Over the years, he has conducted choirs in Latvia, Estonia, and Finland, including in Helsinki, and has been actively involved in organizing choir events since 2013. His education also includes studies at the Estonian Academy of Music and Theatre, strengthening his ties with the Baltic choral tradition.</p>
          <p>Together, MatÄ«ss and Rihards shape the sound and spirit of ZiemeÄ¼u Balsis, guiding the choir to new heights while keeping alive the joy of singing that unites us all.</p>
        </div>
     <div class="about-grid">
  <div class="portrait-card">
    <img class="portrait-img" src="images/matiss-briedis.jpg" alt="MatÄ«ss Briedis">
    <div class="portrait-caption">MatÄ«ss Briedis</div>
  </div>
  <div class="portrait-card">
    <img class="portrait-img" src="images/rihards-zarins.jpg" alt="Rihards ZariÅ†Å¡">
    <div class="portrait-caption">Rihards ZariÅ†Å¡</div>
  </div>
</div>
      </section>

      <!-- REHEARSALS -->
      <section id="rehearsals">
        <h2>Rehearsals</h2>
        <div class="grid two">
          <div class="card">
            <h3>Tartu</h3>
            <p><strong>When:</strong> Wednesdays, 18:00</p>
            <p><strong>Address:</strong> Juhan Liivi 2d (Tartu International School)</p>
            <a class="link-badge" href="https://maps.app.goo.gl/HuaBaZHCtEGC3KhYA" target="_blank" rel="noopener">ğŸŒ Open in Google Maps</a>
          </div>
          <div class="card">
            <h3>Tallinn</h3>
            <p><strong>When:</strong> Wednesdays, 18:00</p>
            <p><strong>Address:</strong> TÃµnismÃ¤gi 10, 15190 Tallinn</p>
            <a class="link-badge" href="https://www.google.com/maps/place/T%C3%B5nism%C3%A3gi+10,+15190+Tallinn,+Igaunija/" target="_blank" rel="noopener">ğŸŒ Open in Google Maps</a>
          </div>
        </div>
      </section>

      <!-- MEDIA (compact) -->
      <section id="news">
        <style>
          /* Compact media cards (scoped to #news) */
          #news .news-grid{display:grid;gap:.9rem;grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
          #news .news-card{border:1px solid var(--border);border-radius:14px;background:#fff;padding:.85rem .9rem}
          #news .news-card h3{font-size:1rem;line-height:1.35;margin:0 0 .45rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
          #news .meta-row{display:flex;align-items:center;gap:.45rem;color:#64748b;font-size:.9rem;margin-bottom:.45rem}
          #news .meta-row img{width:16px;height:16px;border-radius:4px;flex:0 0 16px}
          #news .actions{margin-top:.25rem}
          #news .read-link{font-size:.92rem;text-decoration:none;display:inline-flex;align-items:center;gap:.35rem;padding:.35rem .55rem;border:1px solid var(--border);border-radius:999px;color:var(--brand);background:#FFF5F7}
          #news .read-link:hover{filter:brightness(.97)}
          #news .toggle-wrap{text-align:center;margin-top:.8rem}
          #news .toggle-btn{background:var(--brand);color:#fff;border:1px solid var(--brand);padding:.5rem .9rem;border-radius:999px;cursor:pointer;font-size:.95rem}
        </style>

        <h2>Media</h2>
        <div class="news-grid" id="mediaGrid">
          <article class="news-card">
  <h3>TrÄ«s Baltijas Dziesmu svÄ“tki pÄ“c kÄrtas â€“ kora â€œZiemeÄ¼u Balsisâ€ Ä«paÅ¡ais stÄsts</h3>
  <div class="meta-row" data-domain="www.latviesi.com"><img alt="" /><span>LatvieÅ¡i.com</span></div>
  <div class="actions"><a class="read-link" href="https://www.latviesi.com/jaunumi/tris-baltijas-dziesmu-svetki-pec-kartas-kora-ziemelu-balsis-ipasais-stasts" target="_blank" rel="noopener">Read â†’</a></div>
</article>
          <article class="news-card">
            <h3>TrÄ«s gadi, trÄ«s dziesmusvÄ“tki â€” kÄ korim â€œZiemeÄ¼u Balsisâ€ izdevÄs paveikt Ä«paÅ¡u izaicinÄjumu</h3>
            <div class="meta-row" data-domain="www.delfi.lv"><img alt="" /><span>Delfi</span></div>
            <div class="actions"><a class="read-link" href="https://www.delfi.lv/kultura/50055687/dziesmu-un-deju-svetki/120079550/tris-gadi-tris-dziesmusvetki-ka-korim-ziemelu-balsis-izdevas-pieveikt-ipasu-izaicinajumu" target="_blank" rel="noopener">Read â†’</a></div>
          </article>

          <article class="news-card">
            <h3>CeÄ¼Ä iz Baltejis valstÅ« dzÄ«smu svÄtku â€œhat trickâ€</h3>
            <div class="meta-row" data-domain="www.lakuga.lv"><img alt="" /><span>Lakuga</span></div>
            <div class="actions"><a class="read-link" href="https://www.lakuga.lv/2024/07/18/cela-iz-baltejis-valstu-dzismu-svatku-hat-trick-aba-voi-ogurcs-beja/" target="_blank" rel="noopener">Read â†’</a></div>
          </article>

          <article class="news-card">
            <h3>LR2: IelÄ«goÅ¡ana ar Igaunijas latvieÅ¡u kori â€œZiemeÄ¼u Balsisâ€</h3>
            <div class="meta-row" data-domain="lr2.lsm.lv"><img alt="" /><span>Latvijas Radio 2</span></div>
            <div class="actions"><a class="read-link" href="https://lr2.lsm.lv/lv/raksts/gadsimta-garaka-ligodziesma/ieligosana-ar-igaunijas-latviesu-kori-ziemelu-balsis.a193591/" target="_blank" rel="noopener">Read â†’</a></div>
          </article>

          <article class="news-card">
            <h3>KÄ Igaunijas latvieÅ¡u koris â€œZiemeÄ¼u Balsisâ€ ar dziesmu stiprina Baltijas vienotÄ«bu</h3>
            <div class="meta-row" data-domain="sejas.tvnet.lv"><img alt="" /><span>TVNET</span></div>
            <div class="actions"><a class="read-link" href="https://sejas.tvnet.lv/8046169/foto-un-video-ka-igaunijas-latviesu-koris-ziemelu-balsis-ar-dziesmu-stiprina-baltijas-vienotibu" target="_blank" rel="noopener">Read â†’</a></div>
          </article>

          <article class="news-card">
            <h3>It's an honor: 3 expats on why they're taking part in Estonia's Song Festival</h3>
            <div class="meta-row" data-domain="news.err.ee"><img alt="" /><span>ERR News (ENG)</span></div>
            <div class="actions"><a class="read-link" href="https://news.err.ee/1609735050/it-s-an-honor-3-expats-on-why-they-re-taking-part-in-estonia-s-song-festival" target="_blank" rel="noopener">Read â†’</a></div>
          </article>

          <article class="news-card">
            <h3>LÃ¤ti-Eesti koori dirigent: ootan vÃ¤ga, et laulu vÃ¤gi ajaks vihma minema</h3>
            <div class="meta-row" data-domain="kultuur.err.ee"><img alt="" /><span>ERR Kultuur</span></div>
            <div class="actions"><a class="read-link" href="https://kultuur.err.ee/1609738668/lati-eesti-koori-dirigent-ootan-vaga-et-lauluvoim-ajaks-vihma-minema" target="_blank" rel="noopener">Read â†’</a></div>
          </article>

          <article class="news-card">
            <h3>Leedu tÃ¤histab laulupeo sajandat sÃ¼nnipÃ¤eva</h3>
            <div class="meta-row" data-domain="kultuur.err.ee"><img alt="" /><span>ERR Kultuur</span></div>
            <div class="actions"><a class="read-link" href="https://kultuur.err.ee/1609387721/leedu-tahistab-laulupeo-sajandat-sunnipaeva" target="_blank" rel="noopener">Read â†’</a></div>
          </article>

          <article class="news-card">
            <h3>Laulupidu â€” see on huulepulk</h3>
            <div class="meta-row" data-domain="www.sirp.ee"><img alt="" /><span>Sirp</span></div>
            <div class="actions"><a class="read-link" href="https://www.sirp.ee/laulupidu-see-on-huulepulk/" target="_blank" rel="noopener">Read â†’</a></div>
          </article>
        </div>

        <div class="toggle-wrap">
          <button class="toggle-btn" id="mediaToggle">Show more</button>
        </div>

        <script>
          // Favicons per source
          document.querySelectorAll('#news .meta-row').forEach(row => {
            const d = row.getAttribute('data-domain');
            const img = row.querySelector('img');
            img.src = `https://www.google.com/s2/favicons?domain=${encodeURIComponent(d)}&sz=64`;
          });

          // Show only first 6 by default
          const cards = Array.from(document.querySelectorAll('#news .news-card'));
          const toggle = document.getElementById('mediaToggle');
          const initial = 8;
          function applyClamp(collapsed) {
            cards.forEach((card, i) => { card.style.display = (collapsed && i >= initial) ? 'none' : ''; });
            toggle.textContent = collapsed ? 'Show more' : 'Show less';
          }
          let collapsed = true;
          applyClamp(collapsed);
          toggle.addEventListener('click', () => { collapsed = !collapsed; applyClamp(collapsed); });
        </script>
      </section>

      <!-- GALLERY -->
      <section id="gallery">
        <h2>Gallery</h2>

        <!-- 16:9 video on top -->
        <div style="margin:0 0 1rem 0;max-width:1000px;">
          <iframe
            src="https://www.youtube.com/embed/ULzgT8_4hVk?start=50&modestbranding=1&rel=0"
            title="ZiemeÄ¼u Balsis video"
            loading="lazy"
            allowfullscreen
            style="width:100%; aspect-ratio:16 / 9; border:0; border-radius:14px;"
          ></iframe>
        </div>

        <!-- Photos -->
        <div class="gallery">
          <img src="images/hero.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/about1.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/about2.jpg" alt="Choir photo" onerror="this.remove()">

          <img src="images/Koris 1.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 2.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 3.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 4.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 5.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 6.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 12.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 13.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 15.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 16.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 18.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 19.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 20.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 21.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 22.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 23.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 24.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 25.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 27.jpg" alt="Choir photo" onerror="this.remove()">
          <img src="images/Koris 29.jpg" alt="Choir photo" onerror="this.remove()">
        </div>
      </section>

      <footer id="contact">
        <p><strong>Contacts</strong></p>
        <p>Email: <a href="mailto:ziemelu.balsis@gmail.com">ziemelu.balsis@gmail.com</a> â€¢ Tel: +372 56266439</p>
        <p><a href="https://www.facebook.com/profile.php?id=100091946864543" target="_blank" rel="noopener">Facebook</a> â€¢
           <a href="https://www.instagram.com/ziemelu.balsis" target="_blank" rel="noopener">Instagram</a></p>
      </footer>
      </div>
</main>
  </div>

  <script>
    // (If you ever re-add the Â© year)
    // document.getElementById('year').textContent = new Date().getFullYear();
  </script>
<!-- Simple lightbox -->
<div class="lightbox" id="lightbox" tabindex="-1" aria-hidden="true">
  <img alt="">
</div>
<script>
  (function(){
    const box = document.getElementById('lightbox');
    const big = box.querySelector('img');
    document.querySelectorAll('#gallery img').forEach(img=>{
      img.addEventListener('click',()=>{
        big.src = img.src;
        box.classList.add('open');
        box.focus();
      });
    });
    box.addEventListener('click',()=>box.classList.remove('open'));
    document.addEventListener('keydown',e=>{
      if(e.key==='Escape') box.classList.remove('open');
    });
  })();
</script>
  <script>
  // Auto-highlight the active section in the sidebar
  (function(){
    const links = Array.from(document.querySelectorAll('aside nav a[href^="#"]'));
    const map = new Map(
      links.map(a => [a.getAttribute('href'), a])
    );

    const observer = new IntersectionObserver((entries) => {
      // Find the most visible section entry that is intersecting
      const visible = entries
        .filter(e => e.isIntersecting)
        .sort((a, b) => b.intersectionRatio - a.intersectionRatio)[0];
      if (!visible) return;

      const id = '#' + visible.target.id;
      links.forEach(a => a.classList.toggle('active', a.getAttribute('href') === id));
    }, {
      root: null,
      rootMargin: '-20% 0px -60% 0px', // trigger a bit before the section center
      threshold: [0.1, 0.25, 0.5, 0.75]
    });

    // Observe each section that has a matching sidebar link
    document.querySelectorAll('main section[id]').forEach(sec => {
      if (map.has('#' + sec.id)) observer.observe(sec);
    });

    // If user clicks a link, make it active immediately (nice UX)
    links.forEach(a => {
      a.addEventListener('click', () => {
        links.forEach(x => x.classList.remove('active'));
        a.classList.add('active');
      });
    });
  })();
</script>
</body>
</html>
